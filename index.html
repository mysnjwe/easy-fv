<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy FV - Prosty i Darmowy Generator Faktur Online</title>
    <meta name="description" content="Easy FV to prosty, darmowy program do tworzenia faktur online. Idealny dla freelancerów i małych firm. Twórz profesjonalne faktury szybko i łatwo!">
    <meta name="keywords" content="program do faktur, Easy FV, faktury online, darmowe faktury, generator faktur, faktury dla freelancerów, narzędzie do faktur">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4FACFE;
            --primary-hover: #3d98e7;
            --primary-light: #E9F6FF;
            --background: #FFFFFF;
            --card-bg: #FFFFFF;
            --accent: #F2F7FF;
            --mint: #E0FFF8;
            --text: #2B3A55;
            --text-light: #8E9AAF;
            --border: #EDF2F7;
            --border-focus: #D0E3FF;
            --success: #67E8B4;
            --success-light: #E7FFF5;
            --warning: #FFD572;
            --danger: #FF7A87;
            --radius: 12px;
            --radius-sm: 8px;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
            --transition: all 0.2s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            color: var(--text);
            background-color: var(--background);
            line-height: 1.6;
            font-size: 0.95rem;
            font-weight: 400;
        }

        .container {
            width: 100%;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .login-container {
            max-width: 460px;
            margin: 5rem auto;
            background: var(--card-bg);
            padding: 3rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 0;
            margin-bottom: 3rem;
        }

        .logo {
            font-weight: 600;
            font-size: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            background: linear-gradient(135deg, var(--primary) 0%, #00C6FB 100%);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            letter-spacing: -1px;
            box-shadow: 0 4px 10px rgba(0, 198, 251, 0.2);
        }

        .nav {
            display: flex;
            gap: 1rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 0.9375rem;
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition);
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.2);
        }

        .btn:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(79, 172, 254, 0.25);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: var(--accent);
            color: var(--text);
            box-shadow: var(--shadow-sm);
        }

        .btn-secondary:hover {
            background-color: var(--primary-light);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.03);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--border);
            box-shadow: none;
        }

        .btn-outline:hover {
            background-color: var(--primary-light);
            border-color: var(--primary);
            box-shadow: none;
        }

        .form-group {
            margin-bottom: 1.75rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            font-size: 0.9rem;
            color: var(--text);
        }

        input, select, textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 0.9375rem;
            transition: var(--transition);
            color: var(--text);
            background-color: var(--card-bg);
            box-shadow: var(--shadow-sm);
        }

        input::placeholder, select::placeholder, textarea::placeholder {
            color: var(--text-light);
        }

        input:hover, select:hover, textarea:hover {
            border-color: var(--border-focus);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.15);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: var(--transition);
            border: 1px solid var(--border);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.75rem;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
            font-size: 0.9375rem;
        }

        th, td {
            padding: 1rem;
            text-align: left;
        }

        th {
            font-weight: 600;
            color: var(--text);
            background-color: var(--accent);
        }

        tr {
            border-bottom: 1px solid var(--border);
        }

        tbody tr:hover {
            background-color: var(--primary-light);
        }

        .text-right {
            text-align: right;
        }

        .text-center {
            text-align: center;
        }

        .item-row {
            display: grid;
            grid-template-columns: 2fr 0.5fr 0.5fr 1fr 0.75fr 1fr 1fr 0.2fr;
            gap: 0.75rem;
            margin-bottom: 1rem;
            align-items: center;
        }

        .item-row input, .item-row select {
            padding: 0.75rem;
        }

        .invoice-preview {
            padding: 3rem;
            background: white;
            box-shadow: var(--shadow);
            border-radius: var(--radius);
            max-width: 880px;
            margin: 0 auto;
            border: 1px solid var(--border);
        }

        .summary-table {
            width: auto;
            margin-left: auto;
            border-spacing: 0;
        }

        .summary-table th, .summary-table td {
            padding: 0.75rem 1.25rem;
            border-bottom: none;
        }

        .summary-table tr:last-child {
            border-top: 2px solid var(--border);
            font-weight: 600;
        }

        .tab-container {
            margin-bottom: 2.5rem;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 2.5rem;
        }

        .tab {
            padding: 1rem 1.75rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: var(--text-light);
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab:hover {
            color: var(--text);
        }

        .tab.active {
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
        }

        .tab-content {
            margin-top: 1.5rem;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        .mt-2 {
            margin-top: 1.5rem;
        }

        .actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-success {
            background-color: var(--success-light);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(255, 213, 114, 0.15);
            color: var(--warning);
        }

        .icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2;
        }

        .add-item-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            color: var(--primary);
            font-weight: 500;
            cursor: pointer;
            padding: 0.875rem;
            border-radius: var(--radius);
            transition: var(--transition);
            border: 1px dashed var(--border);
            background: transparent;
            width: 100%;
            margin-top: 0.5rem;
        }

        .add-item-btn:hover {
            background-color: var(--primary-light);
            border-color: var(--primary);
        }

        .action-icon-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            background-color: var(--accent);
            color: var(--text);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .action-icon-btn:hover {
            background-color: var(--primary-light);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .remove-item-btn {
            background-color: var(--danger);
            color: white;
        }

        .remove-item-btn:hover {
            background-color: #e66570;
            color: white;
        }

        .section {
            background-color: var(--accent);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .preview-section {
            background-color: var(--primary-light);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .preview-box {
            background-color: white;
            border-radius: var(--radius-sm);
            padding: 1.25rem;
            box-shadow: var(--shadow-sm);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .fadeIn {
            animation: fadeIn 0.3s ease forwards;
        }

        .fadeOut {
            animation: fadeOut 0.3s ease forwards;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .invoice-preview, .invoice-preview * {
                visibility: visible;
            }
            .invoice-preview {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
                border: none;
            }
        }

        .seo-content {
            display: none;
        }
    </style>
</head>
<body>
    <div id="login-screen" style="display: none;">
        <div class="login-container">
            <div style="text-align: center; margin-bottom: 2.5rem;">
                <div style="display: flex; align-items: center; justify-content: center; gap: 0.75rem; margin-bottom: 1.25rem;">
                    <div class="logo-icon">Fv</div>
                    <h1 style="font-size: 1.75rem; color: var(--text); font-weight: 600;">Easy FV</h1>
                </div>
                <p style="color: var(--text-light);">Twórz faktury szybko i profesjonalnie</p>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" id="email" required placeholder="twoj@email.pl">
                </div>
                <div class="form-group">
                    <label for="password">Hasło</label>
                    <input type="password" id="password" required placeholder="••••••••">
                </div>
                <button type="submit" class="btn" style="width: 100%;">Zaloguj się</button>
                <p style="text-align: center; margin-top: 1.5rem; font-size: 0.875rem; color: var(--text-light);">
                    Nie masz konta? <a href="#" id="register-link" style="color: var(--primary); text-decoration: none; font-weight: 500;">Zarejestruj się</a>
                </p>
            </form>
        </div>
    </div>

    <div id="app-screen">
        <header class="container">
            <div class="logo">
                <div class="logo-icon">Fv</div>
                Easy FV
            </div>
            <div class="nav">
                <a href="#" class="btn btn-secondary" id="btn-invoices">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Moje faktury
                </a>
                <a href="#" class="btn" id="btn-new-invoice">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Nowa faktura
                </a>
            </div>
        </header>

        <div class="container">
            <div id="invoice-list-screen" style="display: none;">
                <h1 style="font-size: 1.75rem; margin-bottom: 2rem; font-weight: 600;">Moje faktury</h1>
                <div class="card">
                    <table id="invoices-table">
                        <thead>
                            <tr>
                                <th style="border-radius: var(--radius-sm) 0 0 var(--radius-sm);">Numer</th>
                                <th>Data wystawienia</th>
                                <th>Nabywca</th>
                                <th>Kwota brutto</th>
                                <th>Status</th>
                                <th style="border-radius: 0 var(--radius-sm) var(--radius-sm) 0; text-align: right;">Akcje</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>FV/2025/02/001</td>
                                <td>28.02.2025</td>
                                <td>ABC Company</td>
                                <td>1 230,00 zł</td>
                                <td><span class="badge badge-success">Zapłacono</span></td>
                                <td class="text-right">
                                    <button class="action-icon-btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                    </button>
                                    <button class="action-icon-btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                            <polyline points="7 10 12 15 17 10"></polyline>
                                            <line x1="12" y1="15" x2="12" y2="3"></line>
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>FV/2025/01/003</td>
                                <td>15.01.2025</td>
                                <td>Tech Solutions Sp. z o.o.</td>
                                <td>3 567,00 zł</td>
                                <td><span class="badge badge-warning">Do zapłaty</span></td>
                                <td class="text-right">
                                    <button class="action-icon-btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                    </button>
                                    <button class="action-icon-btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                            <polyline points="7 10 12 15 17 10"></polyline>
                                            <line x1="12" y1="15" x2="12" y2="3"></line>
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="new-invoice-screen">
                <h1 style="font-size: 1.75rem; margin-bottom: 2rem; font-weight: 600;">Nowa faktura</h1>
                
                <div class="seo-content">
                    <h2>O Easy FV – Darmowy Program do Faktur</h2>
                    <p>Easy FV to nowoczesny, darmowy program online do tworzenia faktur VAT. Nasze narzędzie jest idealne dla freelancerów, małych firm i przedsiębiorców, którzy chcą szybko i profesjonalnie generować faktury. Oferujemy intuicyjny interfejs, możliwość pobierania faktur w formacie PDF i HTML, oraz responsywny design na urządzenia mobilne i desktopowe.</p>
                    <p>Korzystaj z Easy FV, aby tworzyć faktury online bez instalacji, z funkcjami takimi jak podgląd faktury, edycja pozycji, obliczanie podatków VAT (23%, 8%, 5%, 0%, zw.) i zarządzanie danymi sprzedawcy oraz nabywcy. Nasz program wspiera różne sposoby płatności, takie jak przelew, gotówka czy karta płatnicza, oraz pozwala zapisać faktury jako szkice.</p>
                    <h3>Dlaczego warto wybrać Easy FV?</h3>
                    <ul>
                        <li>100% darmowy i dostępny online</li>
                        <li>Prosty w obsłudze dla każdego</li>
                        <li>Bezpieczne zarządzanie danymi</li>
                        <li>Obsługa faktur dla firm i osób prywatnych</li>
                    </ul>
                    <p>Sprawdź Easy FV już dziś i zacznij tworzyć profesjonalne faktury w kilka minut! Odwiedź nas na: https://mysnjwe.github.io/easy-fv/</p>
                </div>

                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="invoice-data">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Dane faktury
                        </div>
                        <div class="tab" data-tab="invoice-preview">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            Podgląd
                        </div>
                    </div>
                    
                    <div class="tab-content">
                        <div class="tab-pane active" id="invoice-data">
                            <div class="grid">
                                <div class="card">
                                    <div class="card-title">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                            <line x1="16" y1="2" x2="16" y2="6"></line>
                                            <line x1="8" y1="2" x2="8" y2="6"></line>
                                            <line x1="3" y1="10" x2="21" y2="10"></line>
                                        </svg>
                                        Informacje o fakturze
                                    </div>
                                    <div class="form-group">
                                        <label>Numer faktury</label>
                                        <input type="text" id="invoice-number" value="FV/2025/02/002">
                                    </div>
                                    <div class="grid">
                                        <div class="form-group">
                                            <label>Data wystawienia</label>
                                            <input type="date" id="issue-date" value="2025-02-28">
                                        </div>
                                        <div class="form-group">
                                            <label>Data sprzedaży/dostawy</label>
                                            <input type="date" id="delivery-date" value="2025-02-28">
                                        </div>
                                    </div>
                                    <div class="grid">
                                        <div class="form-group">
                                            <label>Sposób płatności</label>
                                            <select id="payment-method">
                                                <option value="transfer">Przelew</option>
                                                <option value="cash">Gotówka</option>
                                                <option value="card">Karta płatnicza</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>Termin płatności (dni)</label>
                                            <select id="payment-term">
                                                <option value="7">7 dni</option>
                                                <option value="14" selected>14 dni</option>
                                                <option value="30">30 dni</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label>Status płatności</label>
                                        <select id="payment-status">
                                            <option value="not-paid">Do zapłaty</option>
                                            <option value="paid">Zapłacono</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="card">
                                    <div class="card-title">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                                            <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                                        </svg>
                                        Dane sprzedawcy
                                    </div>
                                    <div class="form-group">
                                        <label>Nazwa firmy/osoby</label>
                                        <input type="text" id="seller-name" placeholder="Nazwa firmy/osoby" value="Andrzej Kowalski">
                                    </div>
                                    <div class="form-group">
                                        <label>Adres</label>
                                        <input type="text" id="seller-address" placeholder="Ulica, numer" value="ul. Przedsiębiorcza 1">
                                    </div>
                                    <div class="grid">
                                        <div class="form-group">
                                            <label>Kod pocztowy</label>
                                            <input type="text" id="seller-postal-code" placeholder="00-000" value="01-001">
                                        </div>
                                        <div class="form-group">
                                            <label>Miejscowość</label>
                                            <input type="text" id="seller-city" placeholder="Miasto" value="Warszawa">
                                        </div>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label>NIP</label>
                                        <input type="text" id="seller-tax-id" placeholder="000-000-00-00" value="123-456-78-90">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mt-2">
                                <div class="card-title">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="12" cy="7" r="4"></circle>
                                    </svg>
                                    Dane nabywcy
                                </div>
                                <div class="form-group">
                                    <label>Nazwa firmy/osoby</label>
                                    <input type="text" id="buyer-name" placeholder="Nazwa firmy/osoby">
                                </div>
                                <div class="form-group">
                                    <label>Adres</label>
                                    <input type="text" id="buyer-address" placeholder="Ulica, numer">
                                </div>
                                <div class="grid">
                                    <div class="form-group">
                                        <label>Kod pocztowy</label>
                                        <input type="text" id="buyer-postal-code" placeholder="00-000">
                                    </div>
                                    <div class="form-group">
                                        <label>Miejscowość</label>
                                        <input type="text" id="buyer-city" placeholder="Miasto">
                                    </div>
                                </div>
                                <div class="form-group" style="margin-bottom: 0;">
                                    <label>NIP</label>
                                    <input type="text" id="buyer-tax-id" placeholder="000-000-00-00">
                                </div>
                            </div>
                            
                            <div class="card mt-2">
                                <div class="card-title">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line>
                                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                        <line x1="12" y1="22.08" x2="12" y2="12"></line>
                                    </svg>
                                    Pozycje faktury
                                </div>
                                <div id="invoice-items" style="margin-bottom: 1rem;">
                                    <div class="item-row" style="background-color: var(--accent); padding: 0.75rem; border-radius: var(--radius); margin-bottom: 1rem;">
                                        <strong>Nazwa</strong>
                                        <strong>Ilość</strong>
                                        <strong>J.m.</strong>
                                        <strong>Cena netto</strong>
                                        <strong>VAT</strong>
                                        <strong>Netto</strong>
                                        <strong>Brutto</strong>
                                        <span></span>
                                    </div>
                                    <div class="item-row" id="item-1" style="background-color: var(--primary-light); padding: 0.75rem; border-radius: var(--radius);">
                                        <input type="text" name="item-name" placeholder="Nazwa towaru/usługi">
                                        <input type="number" name="item-quantity" min="1" step="1" value="1" onchange="calculateItemTotals(this)">
                                        <select name="item-unit">
                                            <option value="szt.">szt.</option>
                                            <option value="godz.">godz.</option>
                                            <option value="usł.">usł.</option>
                                            <option value="kg">kg</option>
                                        </select>
                                        <input type="number" name="item-price" min="0" step="0.01" placeholder="0.00" onchange="calculateItemTotals(this)" oninput="calculateItemTotals(this)">
                                        <select name="item-tax" onchange="calculateItemTotals(this)">
                                            <option value="23">23%</option>
                                            <option value="8">8%</option>
                                            <option value="5">5%</option>
                                            <option value="0">0%</option>
                                            <option value="zw">zw.</option>
                                        </select>
                                        <input type="text" name="item-net-value" readonly placeholder="0.00">
                                        <input type="text" name="item-gross-value" readonly placeholder="0.00">
                                        <button class="action-icon-btn remove-item-btn" onclick="removeItem(this)" title="Usuń pozycję">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <polyline points="3 6 5 6 21 6"></polyline>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                
                                <button class="add-item-btn" id="add-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <line x1="12" y1="8" x2="12" y2="16"></line>
                                        <line x1="8" y1="12" x2="16" y2="12"></line>
                                    </svg>
                                    Dodaj pozycję
                                </button>
                                
                                <div class="section mt-2">
                                    <table class="summary-table" id="summary-table">
                                        <tr>
                                            <th>Razem netto:</th>
                                            <td class="text-right" id="total-net">0,00 zł</td>
                                        </tr>
                                        <tr>
                                            <th>Razem podatek VAT:</th>
                                            <td class="text-right" id="total-tax">0,00 zł</td>
                                        </tr>
                                        <tr>
                                            <th style="font-size: 1.1rem; padding-top: 1rem;">Razem brutto:</th>
                                            <td class="text-right" style="font-size: 1.1rem; font-weight: 600; padding-top: 1rem;" id="total-gross">0,00 zł</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="actions">
                                <button class="btn btn-outline" id="save-draft">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                        <polyline points="7 3 7 8 15 8"></polyline>
                                    </svg>
                                    Zapisz jako szkic
                                </button>
                                <button class="btn" id="generate-invoice">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                                        <rect x="6" y="14" width="12" height="8"></rect>
                                    </svg>
                                    Drukuj fakturę
                                </button>
                            </div>
                        </div>
                        
                        <div class="tab-pane" id="invoice-preview">
                            <div class="invoice-preview" id="preview-container">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2.5rem;">
                                    <div>
                                        <h2 style="font-size: 1.75rem; margin-bottom: 0.75rem; font-weight: 600;">Faktura VAT</h2>
                                        <p><strong>Nr</strong> <span id="preview-invoice-number">FV/2025/02/002</span></p>
                                    </div>
                                    <div style="text-align: right;">
                                        <p><strong>Data wystawienia:</strong> <span id="preview-issue-date">28.02.2025</span></p>
                                        <p><strong>Data sprzedaży:</strong> <span id="preview-delivery-date">28.02.2025</span></p>
                                        <p><strong>Termin płatności:</strong> <span id="preview-due-date">14.03.2025</span></p>
                                    </div>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; margin-bottom: 2.5rem;">
                                    <div style="width: 48%;">
                                        <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--text-light); font-weight: 500;">Sprzedawca</h3>
                                        <div class="preview-box">
                                            <p style="font-weight: 600;" id="preview-seller-name">Andrzej Kowalski</p>
                                            <p id="preview-seller-address">ul. Przedsiębiorcza 1</p>
                                            <p id="preview-seller-city">01-001 Warszawa</p>
                                            <p>NIP: <span id="preview-seller-tax-id">123-456-78-90</span></p>
                                        </div>
                                    </div>
                                    <div style="width: 48%;">
                                        <h3 style="font-size: 1rem; margin-bottom: 0.75rem; color: var(--text-light); font-weight: 500;">Nabywca</h3>
                                        <div class="preview-box">
                                            <p style="font-weight: 600;" id="preview-buyer-name">[Nazwa firmy/osoby]</p>
                                            <p id="preview-buyer-address">[Adres]</p>
                                            <p id="preview-buyer-city">[Kod i miasto]</p>
                                            <p>NIP: <span id="preview-buyer-tax-id">[NIP]</span></p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="preview-section">
                                    <table style="margin-bottom: 0; background-color: white; border-radius: var(--radius);">
                                        <thead>
                                            <tr>
                                                <th style="width: 30px; border-radius: var(--radius-sm) 0 0 0;">Lp.</th>
                                                <th>Nazwa towaru/usługi</th>
                                                <th style="width: 60px;">Ilość</th>
                                                <th style="width: 60px;">J.m.</th>
                                                <th>Cena netto</th>
                                                <th>Wartość netto</th>
                                                <th>VAT</th>
                                                <th>Kwota VAT</th>
                                                <th style="border-radius: 0 var(--radius-sm) 0 0;">Wartość brutto</th>
                                            </tr>
                                        </thead>
                                        <tbody id="preview-items">
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; margin-bottom: 2.5rem;">
                                    <div style="width: 60%;">
                                        <p style="margin-bottom: 0.5rem;"><strong>Sposób płatności:</strong> <span id="preview-payment-method">Przelew</span></p>
                                        <p><strong>Słownie:</strong> <span id="preview-amount-in-words">zero złotych 00/100</span></p>
                                    </div>
                                    <div style="width: 35%;">
                                        <div class="section" style="margin-bottom: 0;">
                                            <table style="width: 100%;" id="preview-summary-table">
                                                <tr>
                                                    <th>Razem netto:</th>
                                                    <td class="text-right" id="preview-total-net">0,00 zł</td>
                                                </tr>
                                                <tr>
                                                    <th>Razem VAT:</th>
                                                    <td class="text-right" id="preview-total-tax">0,00 zł</td>
                                                </tr>
                                                <tr style="font-weight: 700;">
                                                    <th>Razem brutto:</th>
                                                    <td class="text-right" id="preview-total-gross">0,00 zł</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 4rem; display: flex; justify-content: space-between;">
                                    <div style="text-align: center; width: 40%;">
                                        <div style="border-top: 1px solid var(--border); padding-top: 0.5rem;">
                                            <p style="color: var(--text-light); font-size: 0.875rem;">Osoba upoważniona do wystawienia</p>
                                        </div>
                                    </div>
                                    <div style="text-align: center; width: 40%;">
                                        <div style="border-top: 1px solid var(--border); padding-top: 0.5rem;">
                                            <p style="color: var(--text-light); font-size: 0.875rem;">Osoba upoważniona do odbioru</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="actions">
                                <button class="btn btn-outline" id="btn-print">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                                        <rect x="6" y="14" width="12" height="8"></rect>
                                    </svg>
                                    Drukuj
                                </button>
                                <button class="btn" id="btn-download-pdf">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    Pobierz PDF
                                </button>
                                <button class="btn btn-secondary" id="btn-download-html">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    Pobierz HTML
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('app-screen').style.display = 'block';

            document.getElementById('btn-download-html').addEventListener('click', downloadHTMLFile);
            
            const firstItemInputs = document.querySelectorAll('#item-1 input, #item-1 select');
            firstItemInputs.forEach(input => {
                if (input.name === 'item-quantity' || input.name === 'item-price') {
                    input.addEventListener('input', function() {
                        calculateItemTotals(this);
                    });
                } else if (input.name === 'item-tax') {
                    input.addEventListener('change', function() {
                        calculateItemTotals(this);
                    });
                }
            });
        });
        
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
                const pane = document.getElementById(this.dataset.tab);
                pane.classList.add('active');
                pane.classList.add('fadeIn');
                
                if (this.dataset.tab === 'invoice-preview') {
                    updatePreview();
                }
            });
        });
        
        document.getElementById('add-item').addEventListener('click', function() {
            const itemsContainer = document.getElementById('invoice-items');
            const itemCount = itemsContainer.querySelectorAll('.item-row').length - 1;
            const newItem = document.createElement('div');
            newItem.className = 'item-row';
            newItem.id = `item-${itemCount + 1}`;
            newItem.style.backgroundColor = 'var(--primary-light)';
            newItem.style.padding = '0.75rem';
            newItem.style.borderRadius = 'var(--radius)';
            newItem.style.marginBottom = '1rem';
            newItem.style.display = 'grid';
            newItem.style.gridTemplateColumns = '2fr 0.5fr 0.5fr 1fr 0.75fr 1fr 1fr 0.2fr';
            newItem.innerHTML = `
                <input type="text" name="item-name" placeholder="Nazwa towaru/usługi">
                <input type="number" name="item-quantity" min="1" step="1" value="1" onchange="calculateItemTotals(this)" oninput="calculateItemTotals(this)">
                <select name="item-unit">
                    <option value="szt.">szt.</option>
                    <option value="godz.">godz.</option>
                    <option value="usł.">usł.</option>
                    <option value="kg">kg</option>
                </select>
                <input type="number" name="item-price" min="0" step="0.01" placeholder="0.00" onchange="calculateItemTotals(this)" oninput="calculateItemTotals(this)">
                <select name="item-tax" onchange="calculateItemTotals(this)">
                    <option value="23">23%</option>
                    <option value="8">8%</option>
                    <option value="5">5%</option>
                    <option value="0">0%</option>
                    <option value="zw">zw.</option>
                </select>
                <input type="text" name="item-net-value" readonly placeholder="0.00">
                <input type="text" name="item-gross-value" readonly placeholder="0.00">
                <button class="action-icon-btn remove-item-btn" onclick="removeItem(this)" title="Usuń pozycję">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                </button>
            `;
            itemsContainer.appendChild(newItem);
            newItem.classList.add('fadeIn');
            
            const inputs = newItem.querySelectorAll('input, select');
            inputs.forEach(input => {
                if (input.name === 'item-quantity' || input.name === 'item-price') {
                    input.addEventListener('input', function() {
                        calculateItemTotals(this);
                    });
                }
            });
        });

        function removeItem(button) {
            const row = button.closest('.item-row');
            row.classList.add('fadeOut');
            setTimeout(() => {
                row.remove();
                updateTotals();
            }, 300);
        }
        
        function calculateItemTotals(element) {
            const row = element.closest('.item-row');
            const quantity = parseFloat(row.querySelector('[name="item-quantity"]').value) || 0;
            const price = parseFloat(row.querySelector('[name="item-price"]').value) || 0;
            const taxRate = row.querySelector('[name="item-tax"]').value;
            const netValue = quantity * price;
            let grossValue = netValue;
            
            if (taxRate !== 'zw') {
                grossValue = netValue * (1 + parseFloat(taxRate) / 100);
            }
            
            row.querySelector('[name="item-net-value"]').value = netValue.toFixed(2);
            row.querySelector('[name="item-gross-value"]').value = grossValue.toFixed(2);
            
            updateTotals();
        }
        
        function calculateInvoiceTotal() {
            let totalGross = 0;
            document.querySelectorAll('.item-row').forEach((row, index) => {
                if (index === 0) return;
                const grossValue = parseFloat(row.querySelector('[name="item-gross-value"]').value) || 0;
                totalGross += grossValue;
            });
            return totalGross;
        }
        
        function updateTotals() {
            let totalNet = 0;
            let totalTax = 0;
            let totalGross = 0;
            const taxRateTotals = {};
            
            document.querySelectorAll('.item-row').forEach((row, index) => {
                if (index === 0) return;
                const netValue = parseFloat(row.querySelector('[name="item-net-value"]').value) || 0;
                const grossValue = parseFloat(row.querySelector('[name="item-gross-value"]').value) || 0;
                const taxRate = row.querySelector('[name="item-tax"]').value;
                
                totalNet += netValue;
                totalGross += grossValue;
                const taxAmount = grossValue - netValue;
                totalTax += taxAmount;
                
                if (taxRate !== 'zw') {
                    if (!taxRateTotals[taxRate]) {
                        taxRateTotals[taxRate] = 0;
                    }
                    taxRateTotals[taxRate] += taxAmount;
                }
            });
            
            document.getElementById('total-net').textContent = formatCurrency(totalNet);
            document.getElementById('total-tax').textContent = formatCurrency(totalTax);
            document.getElementById('total-gross').textContent = formatCurrency(totalGross);
            
            const summaryTable = document.getElementById('summary-table');
            const rows = summaryTable.getElementsByTagName('tr');
            const totalRows = rows.length;
            
            if (totalRows > 3) {
                for (let i = totalRows - 4; i >= 0; i--) {
                    summaryTable.removeChild(rows[i + 1]);
                }
            }
            
            const totalTaxRow = summaryTable.querySelector('tr:nth-child(2)');
            Object.keys(taxRateTotals).sort((a, b) => b - a).forEach(rate => {
                if (taxRateTotals[rate] > 0) {
                    const taxRow = document.createElement('tr');
                    taxRow.innerHTML = `
                        <th>Podatek VAT (${rate}%):</th>
                        <td class="text-right">${formatCurrency(taxRateTotals[rate])}</td>
                    `;
                    summaryTable.insertBefore(taxRow, totalTaxRow);
                }
            });
            
            document.getElementById('preview-amount-in-words').textContent = amountInWords(totalGross);
        }
        
        function updatePreviewSummary(taxRateTotals, totalNet, totalTax, totalGross) {
            const previewSummaryTable = document.getElementById('preview-summary-table');
            const rows = previewSummaryTable.getElementsByTagName('tr');
            const totalRows = rows.length;
            
            if (totalRows > 3) {
                for (let i = totalRows - 4; i >= 0; i--) {
                    previewSummaryTable.removeChild(rows[i + 1]);
                }
            }
            
            const totalTaxRow = previewSummaryTable.querySelector('tr:nth-child(2)');
            Object.keys(taxRateTotals).sort((a, b) => b - a).forEach(rate => {
                if (taxRateTotals[rate] > 0) {
                    const taxRow = document.createElement('tr');
                    taxRow.innerHTML = `
                        <th>Podatek VAT (${rate}%):</th>
                        <td class="text-right">${formatCurrency(taxRateTotals[rate])}</td>
                    `;
                    previewSummaryTable.insertBefore(taxRow, totalTaxRow);
                }
            });
            
            document.getElementById('preview-total-net').textContent = formatCurrency(totalNet);
            document.getElementById('preview-total-tax').textContent = formatCurrency(totalTax);
            document.getElementById('preview-total-gross').textContent = formatCurrency(totalGross);
        }
        
        function formatCurrency(value) {
            const formatted = value.toFixed(2).replace('.', ',').replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
            return `${formatted} zł`;
        }

        function amountInWords(amount) {
            if (isNaN(amount) || amount === undefined) {
                amount = 0;
            }
            amount = parseFloat(amount.toFixed(2));
            const zloty = Math.floor(amount);
            const grosze = Math.round((amount - zloty) * 100);
            
            const units = ['', 'jeden', 'dwa', 'trzy', 'cztery', 'pięć', 'sześć', 'siedem', 'osiem', 'dziewięć'];
            const teens = ['dziesięć', 'jedenaście', 'dwanaście', 'trzynaście', 'czternaście', 'piętnaście', 'szesnaście', 'siedemnaście', 'osiemnaście', 'dziewiętnaście'];
            const tens = ['', 'dziesięć', 'dwadzieścia', 'trzydzieści', 'czterdzieści', 'pięćdziesiąt', 'sześćdziesiąt', 'siedemdziesiąt', 'osiemdziesiąt', 'dziewięćdziesiąt'];
            const hundreds = ['', 'sto', 'dwieście', 'trzysta', 'czterysta', 'pięćset', 'sześćset', 'siedemset', 'osiemset', 'dziewięćset'];
            
            function convertLessThanThousand(number) {
                let result = '';
                const h = Math.floor(number / 100);
                number %= 100;
                if (h > 0) {
                    result += hundreds[h] + ' ';
                }
                if (number < 10) {
                    result += units[number];
                } else if (number < 20) {
                    result += teens[number - 10];
                } else {
                    const t = Math.floor(number / 10);
                    const u = number % 10;
                    result += tens[t];
                    if (u > 0) {
                        result += ' ' + units[u];
                    }
                }
                return result.trim();
            }
            
            let result = '';
            if (zloty === 0) {
                result = 'zero';
            } else {
                const thousands = Math.floor(zloty / 1000);
                const remainder = zloty % 1000;
                
                if (thousands > 0) {
                    if (thousands === 1) {
                        result += 'jeden tysiąc';
                    } else {
                        result += convertLessThanThousand(thousands) + ' tysięcy';
                        if (thousands % 10 >= 2 && thousands % 10 <= 4 && (thousands % 100 < 10 || thousands % 100 > 20)) {
                            result = result.slice(0, -8) + "tysiące";
                        }
                    }
                    if (remainder > 0) {
                        result += ' ';
                    }
                }
                
                if (remainder > 0) {
                    result += convertLessThanThousand(remainder);
                }
            }
            
            if (zloty === 1) {
                result += ' złoty';
            } else if (zloty % 10 >= 2 && zloty % 10 <= 4 && (zloty % 100 < 10 || zloty % 100 > 20)) {
                result += ' złote';
            } else {
                result += ' złotych';
            }
            
            result += ' ' + grosze.toString().padStart(2, '0') + '/100';
            return result.charAt(0).toUpperCase() + result.slice(1);
        }
        
        function updatePreview() {
            document.getElementById('preview-invoice-number').textContent = document.getElementById('invoice-number').value;
            const issueDate = new Date(document.getElementById('issue-date').value);
            const deliveryDate = new Date(document.getElementById('delivery-date').value);
            const formatDate = (date) => {
                return date.toLocaleDateString('pl-PL', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\//g, '.');
            };
            document.getElementById('preview-issue-date').textContent = formatDate(issueDate);
            document.getElementById('preview-delivery-date').textContent = formatDate(deliveryDate);
            
            const paymentTerm = parseInt(document.getElementById('payment-term').value);
            const dueDate = new Date(issueDate);
            dueDate.setDate(dueDate.getDate() + paymentTerm);
            document.getElementById('preview-due-date').textContent = formatDate(dueDate);
            
            const paymentMethodSelect = document.getElementById('payment-method');
            const paymentMethodText = paymentMethodSelect.options[paymentMethodSelect.selectedIndex].text;
            document.getElementById('preview-payment-method').textContent = paymentMethodText;
            
            document.getElementById('preview-seller-name').textContent = document.getElementById('seller-name').value || 'Andrzej Kowalski';
            document.getElementById('preview-seller-address').textContent = document.getElementById('seller-address').value || 'ul. Przedsiębiorcza 1';
            const sellerCity = (document.getElementById('seller-postal-code').value + ' ' + document.getElementById('seller-city').value).trim() || '01-001 Warszawa';
            document.getElementById('preview-seller-city').textContent = sellerCity;
            document.getElementById('preview-seller-tax-id').textContent = document.getElementById('seller-tax-id').value || '123-456-78-90';
            
            document.getElementById('preview-buyer-name').textContent = document.getElementById('buyer-name').value || '[Nazwa firmy/osoby]';
            document.getElementById('preview-buyer-address').textContent = document.getElementById('buyer-address').value || '[Adres]';
            const buyerCity = (document.getElementById('buyer-postal-code').value + ' ' + document.getElementById('buyer-city').value).trim() || '[Kod i miasto]';
            document.getElementById('preview-buyer-city').textContent = buyerCity;
            document.getElementById('preview-buyer-tax-id').textContent = document.getElementById('buyer-tax-id').value || '[NIP]';
            
            const previewItems = document.getElementById('preview-items');
            previewItems.innerHTML = '';
            let rowNumber = 1;
            let totalNet = 0;
            let totalTax = 0;
            let totalGross = 0;
            const taxRateTotals = {};
            
            document.querySelectorAll('.item-row').forEach((row, index) => {
                if (index === 0) return;
                const name = row.querySelector('[name="item-name"]').value;
                if (!name) return;
                
                const quantity = row.querySelector('[name="item-quantity"]').value;
                const unit = row.querySelector('[name="item-unit"]').value;
                const price = parseFloat(row.querySelector('[name="item-price"]').value) || 0;
                const netValue = parseFloat(row.querySelector('[name="item-net-value"]').value) || 0;
                const taxRateSelect = row.querySelector('[name="item-tax"]');
                const taxRateValue = taxRateSelect.value;
                const taxRateText = taxRateSelect.options[taxRateSelect.selectedIndex].text;
                const grossValue = parseFloat(row.querySelector('[name="item-gross-value"]').value) || 0;
                const taxAmount = grossValue - netValue;
                
                totalNet += netValue;
                totalGross += grossValue;
                totalTax += taxAmount;
                
                if (taxRateValue !== 'zw') {
                    if (!taxRateTotals[taxRateValue]) {
                        taxRateTotals[taxRateValue] = 0;
                    }
                    taxRateTotals[taxRateValue] += taxAmount;
                }
                
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td>${rowNumber}</td>
                    <td>${name}</td>
                    <td>${quantity}</td>
                    <td>${unit}</td>
                    <td>${formatCurrency(price)}</td>
                    <td>${formatCurrency(netValue)}</td>
                    <td>${taxRateText}</td>
                    <td>${formatCurrency(taxAmount)}</td>
                    <td>${formatCurrency(grossValue)}</td>
                `;
                previewItems.appendChild(newRow);
                rowNumber++;
            });
            
            document.getElementById('preview-total-net').textContent = formatCurrency(totalNet);
            document.getElementById('preview-total-tax').textContent = formatCurrency(totalTax);
            document.getElementById('preview-total-gross').textContent = formatCurrency(totalGross);
            document.getElementById('preview-amount-in-words').textContent = amountInWords(totalGross);
            
            updatePreviewSummary(taxRateTotals, totalNet, totalTax, totalGross);
        }
        
        document.getElementById('btn-print').addEventListener('click', function() {
            window.print();
        });
        
        document.getElementById('btn-download-pdf').addEventListener('click', function() {
            const { jsPDF } = window.jspdf;
            const element = document.getElementById('preview-container');
            html2canvas(element).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save('faktura-easy-fv.pdf');
            });
        });
        
        function downloadHTMLFile() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'faktura-easy-fv.html';
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 0);
        }
        
        document.getElementById('btn-invoices').addEventListener('click', function() {
            document.getElementById('invoice-list-screen').style.display = 'block';
            document.getElementById('new-invoice-screen').style.display = 'none';
        });
        
        document.getElementById('btn-new-invoice').addEventListener('click', function() {
            document.getElementById('invoice-list-screen').style.display = 'none';
            document.getElementById('new-invoice-screen').style.display = 'block';
        });
        
        document.getElementById('generate-invoice').addEventListener('click', function() {
            updatePreview();
            window.print();
        });
    </script>
</body>
</html>
